files:
  /etc/nginx/.htpasswd:
    mode: "000644"
    owner: root
    group: root
    content: |
      matter4:$apr1$gvN8Go4D$IOtFGDriVxEkZCLNpYFSI.

  /tmp/deployment/http_basic_auth.sh:
    mode: "000755"
    content: |
      sed -i 's/$proxy_add_x_forwarded_for;/$proxy_add_x_forwarded_for;\n   auth_basic "Restricted";\n    auth_basic_user_file \/etc\/nginx\/.htpasswd;\n/' "/tmp/deployment/config/#etc#nginx#conf.d#00_elastic_beanstalk_proxy.conf"
      sudo cp /tmp/deployment/config/#etc#nginx#conf.d#00_elastic_beanstalk_proxy.conf /etc/nginx/conf.d/00_elastic_beanstalk_proxy.conf
      sudo /sbin/service nginx restart
      exit 0

container_commands:
  00_http_basic_auth:
    command: "sudo /tmp/deployment/http_basic_auth.sh"
